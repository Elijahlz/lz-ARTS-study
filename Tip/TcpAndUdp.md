#  Unix 网络编程

## 分享一下以一个例子通俗易懂的理解 TCP 的一次连接过程。

建立TCP连接就好比一个电话系统。

socket 函数等同于有电话可用；
bind 函数是在告诉别人你的电话号码，这样他们可以呼叫你；
listen 函数是打开电话振铃，这样当有一个外来呼叫到达时，你就可以听到；
connect 函数要求我们知道对方的电话号码并拨打它；
accept 函数发生在被呼叫的人应答电话之时，由 accept 返回客户的标识(即客户的 IP 地址和端口号)类似于让电话机的呼叫者 ID 功能部件显示呼叫者的电话号码。
然而两者的不同之处在于 accept 只在连接建立之后返回客户的标识，而呼叫者 ID 功能部件却在我们选择应答或不应答电话之前显示呼叫者的电话号码。如果使用域名系统 DNS ，它就提供了一种类似于电话薄的服务， getaddrinfo 类似于在电话簿中查找某个人的电话号码，getnameinfo 则类似于有一本按照电话号码而不是按照用户名排序的电话薄。

下面是 TCP 建立一次连接的过程图






可以看到

客户端调用了一次 write() 函数，一次 read() 函数，一次 close() 函数。
服务端调用了一次 write() 函数，两次 read() 函数，一次 close() 函数。
